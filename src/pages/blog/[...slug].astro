---
import BlogDetailLayout from "@/layouts/BlogDetailLayout.astro";
import { attachCodeHighlight } from "@/libs/codeHighlight";
import { getBlogs, type Blog } from "@/libs/microcms/blog";

type Props = Blog;

export async function getStaticPaths() {
  const res = await getBlogs();
  const posts = res.contents;
  return posts.map((post) => {
    return {
      params: { slug: post.id },
      props: post,
    };
  });
}

const post = Astro.props;
const { title, publishedAt, description, eyecatch, category } = post;

const highlightedArticle = attachCodeHighlight(post.content);
---

<BlogDetailLayout
  title={title}
  description={description}
  pubDate={new Date(publishedAt)}
  heroImage={eyecatch.url}
  categories={category}
>
  <p set:html={highlightedArticle} />
</BlogDetailLayout>
