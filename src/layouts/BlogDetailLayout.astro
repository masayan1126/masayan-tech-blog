---
import FormattedDate from "@/components/FormattedDate.astro";
import "@fontsource-variable/noto-sans-jp";
import BaseLayout from "@/layouts/BaseLayout.astro";
import { getArticlesByCategory } from "@/libs/microcms/blog";
import Link from "@/components/Link/Link.astro";
import buildFilter from "@/libs/microcms/buildFilter";
import { Icon } from "astro-icon";
import { BlogListLink } from "@/features/Blog/List/BlogListLink";
import BlogDetailProfileCard from "@/features/Blog/Detail/BlogDetailProfileCard.astro";
import { SITE_DOMAIN } from "@/constants/url";
import { ARTICLES_PATH } from "@/features/Blog/List/constants/path";
import type { Article } from "@/libs/microcms/blog";
import ScrollToTop from "@/components/ScrollToTop.astro";
import { LinkCardReplacer } from "@/features/LinkCard/LinkCardReplacer";

type Props = Article;

const { title, description, publishedAt, revisedAt, category, youtube_link, eyecatch } = Astro.props;
const { slug } = Astro.params;




const catetoryIds = category.map(({ id }) => id);
const filter = buildFilter("categoryId", catetoryIds);
const relatedPostsRes = await getArticlesByCategory(filter);
const relatedRandomPosts = [...relatedPostsRes.contents].sort(() => {
  return Math.random() - 0.5;
});

console.log(youtube_link);

// YouTube URL„Åã„ÇâVideo ID„ÇíÊäΩÂá∫
function extractVideoId(youtubeUrl: string): string | null {
  const patterns = [
    /(?:youtube\.com\/watch\?v=|youtu\.be\/)([^&\s]+)/,
    /youtube\.com\/embed\/([^?&\s]+)/,
  ];

  for (const pattern of patterns) {
    const match = youtubeUrl.match(pattern);
    if (match && match[1]) {
      return match[1];
    }
  }

  return null;
}

// VideoObjectÊßãÈÄ†Âåñ„Éá„Éº„Çø„ÇíÁîüÊàê
let videoStructuredData = null;
if (youtube_link) {
  const videoId = extractVideoId(youtube_link);
  if (videoId) {
    videoStructuredData = {
      "@context": "https://schema.org",
      "@type": "VideoObject",
      "name": title,
      "description": description || title,
      "thumbnailUrl": `https://i.ytimg.com/vi/${videoId}/maxresdefault.jpg`,
      "uploadDate": publishedAt,
      "contentUrl": `https://www.youtube.com/watch?v=${videoId}`,
      "embedUrl": `https://www.youtube.com/embed/${videoId}`,
    };
  }
}

const breadCrumbsList = [
  {
    name: "„Éõ„Éº„É†",
    path: `/`,
  },
  {
    name: "„Éñ„É≠„Ç∞Ë®ò‰∫ã‰∏ÄË¶ß",
    path: ARTICLES_PATH,
  },
  {
    name: title,
    path: `/blog/${slug}/`,
  },
];
---

<BaseLayout
  {title}
  {description}
  context={"blog"}
  {breadCrumbsList}
>
  {videoStructuredData && (
    <Fragment slot="head">
      <script type="application/ld+json" is:inline set:html={JSON.stringify(videoStructuredData)} />
    </Fragment>
  )}
  <div class="blog-detail-wrapper">
    <div class="main">
      <!-- Ë®ò‰∫ã„Éò„ÉÉ„ÉÄ„Éº -->
      <header class="article-header">
        <!-- „Ç´„ÉÜ„Ç¥„É™„Éê„ÉÉ„Ç∏ -->
        <div class="article-categories">
          {category.map(({ id, name }) => (
            <a href={`/category/${id}${ARTICLES_PATH}`} class="article-category-badge">
              <span class="category-dot"></span>
              {name}
            </a>
          ))}
        </div>
        
        <!-- „Çø„Ç§„Éà„É´ -->
        <h1 class="article-title">
          {title}
        </h1>
        
        <!-- „É°„ÇøÊÉÖÂ†± -->
        <div class="article-meta">
          <div class="meta-item">
            <span class="meta-icon-wrapper">
              <Icon name="ph:calendar-bold" class="meta-icon" />
            </span>
            <span class="meta-label">ÂÖ¨Èñã</span>
            <span class="meta-value"><FormattedDate date={new Date(publishedAt)} /></span>
          </div>
          <span class="meta-divider">|</span>
          <div class="meta-item">
            <span class="meta-icon-wrapper">
              <Icon name="ph:pencil-simple-bold" class="meta-icon" />
            </span>
            <span class="meta-label">Êõ¥Êñ∞</span>
            <span class="meta-value"><FormattedDate date={new Date(revisedAt)} /></span>
          </div>
        </div>
        
        <!-- „Éá„Ç≥„É¨„Éº„Ç∑„Éß„É≥„É©„Ç§„É≥ -->
        <div class="article-header-line"></div>
      </header>
      {eyecatch && (
        <div class="article-eyecatch">
          <img
            src={eyecatch.url}
            width={eyecatch.width}
            height={eyecatch.height}
            alt={title}
            class="eyecatch-image"
          />
        </div>
      )}
      {youtube_link && (
        <>
          <p class="youtube-label">„Åì„ÅÆÂÜÖÂÆπ„ÅØYOUTUBEÂãïÁîª„Åß„ÇÇ„ÅîË¶ß„ÅÑ„Åü„Å†„Åë„Åæ„Åô</p>
          <div class="youtube-embed-container mt-8">
            <iframe
              width="100%"
              height="315"
              src={youtube_link.replace('watch?v=', 'embed/')}
              title="YouTube video player"
              frameborder="0"
              allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
              allowfullscreen
            ></iframe>
          </div>
        </>
      )}
      <!-- „É¢„Éê„Ç§„É´Ë°®Á§∫Áî®„ÅÆÁõÆÊ¨° -->
      <div class="toc-mobile">
        <slot name="toc-mobile" />
      </div>
      <article>
        <slot />
      </article>

      <!-- Ë®ò‰∫ãÊúÄÂæå„ÅÆ„Çª„ÇØ„Ç∑„Éß„É≥ -->
      <div class="article-footer-sections">
        <!-- „Åì„ÅÆË®ò‰∫ã„Çí„Ç∑„Çß„Ç¢„Åô„Çã -->
        <div class="share-section">
          <div class="section-header">
            <Icon name="ph:share-network-bold" class="section-header-icon" />
            <h2 class="section-title">SHARE</h2>
            <span class="section-subtitle">„Åì„ÅÆË®ò‰∫ã„Çí„Ç∑„Çß„Ç¢„Åô„Çã</span>
          </div>
          <div class="share-buttons">
            <a
              href={`http://twitter.com/share?url=${SITE_DOMAIN}/blog/${slug}&via=masayanishigaki&text=${title}`}
              target="_blank"
              rel="noopener noreferrer"
              class="share-button share-x"
              aria-label="Share on X"
            >
              <svg class="share-icon" viewBox="0 0 24 24" fill="currentColor">
                <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
              </svg>
              <span class="share-label">X</span>
            </a>
            <a
              href={`http://b.hatena.ne.jp/add?mode=confirm&url=${SITE_DOMAIN}/blog/${slug}&title=${title}`}
              target="_blank"
              rel="noopener noreferrer"
              class="share-button share-hatena"
              aria-label="Share on Hatena"
            >
              <Icon name="simple-icons:hatenabookmark" class="share-icon" />
              <span class="share-label">Hatena</span>
            </a>
            <a
              href={`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(`${SITE_DOMAIN}/blog/${slug}`)}`}
              target="_blank"
              rel="noopener noreferrer"
              class="share-button share-facebook"
              aria-label="Share on Facebook"
            >
              <Icon name="simple-icons:facebook" class="share-icon" />
              <span class="share-label">Facebook</span>
            </a>
            <a
              href={`https://social-plugins.line.me/lineit/share?url=${encodeURIComponent(`${SITE_DOMAIN}/blog/${slug}`)}`}
              target="_blank"
              rel="noopener noreferrer"
              class="share-button share-line"
              aria-label="Share on LINE"
            >
              <Icon name="simple-icons:line" class="share-icon" />
              <span class="share-label">LINE</span>
            </a>
            <a
              href={`https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(`${SITE_DOMAIN}/blog/${slug}`)}`}
              target="_blank"
              rel="noopener noreferrer"
              class="share-button share-linkedin"
              aria-label="Share on LinkedIn"
            >
              <Icon name="simple-icons:linkedin" class="share-icon" />
              <span class="share-label">LinkedIn</span>
            </a>
            <a
              href={`https://getpocket.com/save?url=${encodeURIComponent(`${SITE_DOMAIN}/blog/${slug}`)}&title=${encodeURIComponent(title)}`}
              target="_blank"
              rel="noopener noreferrer"
              class="share-button share-pocket"
              aria-label="Save to Pocket"
            >
              <Icon name="simple-icons:pocket" class="share-icon" />
              <span class="share-label">Pocket</span>
            </a>
          </div>
        </div>

        <!-- Èñ¢ÈÄ£Ë®ò‰∫ã -->
        <div class="related-posts-section">
          <div class="section-header">
            <Icon name="ph:article-bold" class="section-header-icon" />
            <h2 class="section-title">RELATED</h2>
            <span class="section-subtitle">Èñ¢ÈÄ£Ë®ò‰∫ã</span>
          </div>
          <div class="related-posts-grid">
            {
              relatedRandomPosts.map(
                (post, i) =>
                  i < 6 && (
                    <a href={`/blog/${post.id}/`} class="related-post-card">
                      <div class="related-post-content">
                        <div class="related-post-categories">
                          {post.category.slice(0, 2).map((c) => (
                            <span class="related-post-category">{c.name}</span>
                          ))}
                        </div>
                        <h3 class="related-post-title">{post.title}</h3>
                        <div class="related-post-meta">
                          <Icon name="ph:calendar-bold" class="related-meta-icon" />
                          <FormattedDate date={new Date(post.publishedAt)} />
                        </div>
                      </div>
                      <div class="related-post-arrow">
                        <Icon name="ph:arrow-right-bold" class="arrow-icon" />
                      </div>
                    </a>
                  )
              )
            }
          </div>
        </div>

        <!-- „Éñ„É≠„Ç∞ÁÆ°ÁêÜ‰∫∫ -->
        <div class="author-section">
          <div class="section-header">
            <Icon name="ph:user-bold" class="section-header-icon" />
            <h2 class="section-title">AUTHOR</h2>
            <span class="section-subtitle">„Éñ„É≠„Ç∞ÁÆ°ÁêÜ‰∫∫</span>
          </div>
          <BlogDetailProfileCard />
        </div>
      </div>

      <LinkCardReplacer client:load />
      <ScrollToTop />
    </div>
    <aside>
      <!-- PCË°®Á§∫Áî®„ÅÆÁõÆÊ¨°Ôºà„Çπ„ÉÜ„Ç£„ÉÉ„Ç≠„ÉºÔºâ -->
      <slot name="toc-desktop" />
    </aside>
  </div>
</BaseLayout>
<!-- MEMO:ÂãïÁöÑ„Å´ÂèñÂæó„Åó„ÅüË®ò‰∫ã„ÅÆ„Çø„Ç∞„Å´„Çπ„Çø„Ç§„É´„ÇíÂΩì„Å¶„Çã„Å´„ÅØ„ÄÅgloba„Å´„Åô„ÇãÂøÖË¶Å„Åå„ÅÇ„Çã -->
<style is:global>
  article {
    width: 100%;
    overflow-x: scroll;
  }

  article h1::before {
    content: "üî•";
  }

  /* === Ë®ò‰∫ã„Çø„Ç§„Éà„É´ === */
  .article-title {
    font-size: 2rem;
    font-weight: 700;
    margin-bottom: 0;
    display: block;
    color: var(--color-text);
    letter-spacing: -0.02em;
    line-height: 1.4;
  }

  @media (max-width: 768px) {
    .article-title {
      font-size: 1.625rem;
      letter-spacing: -0.01em;
    }
  }

  @media (max-width: 480px) {
    .article-title {
      font-size: 1.375rem;
      line-height: 1.5;
    }
  }

  /* === Ë¶ãÂá∫„Åó„Çπ„Çø„Ç§„É´ === */
  article h2 {
    font-size: 1.5rem;
    font-weight: 700;
    margin: 3.5rem 0 1.5rem;
    padding: 0.75rem 0 0.75rem 1rem;
    border-left: 4px solid var(--color-primary);
    border-bottom: none;
    background: rgba(var(--color-primary-rgb), 0.05);
    color: var(--color-text);
  }

  article h2::before {
    content: none;
  }

  article h3 {
    font-size: 1.25rem;
    font-weight: 700;
    margin: 2.5rem 0 1rem;
    padding: 0 0 0.5rem 0;
    border-bottom: 1px solid var(--color-border);
    color: var(--color-text);
  }

  article h4 {
    font-size: 1.125rem;
    font-weight: 700;
    margin: 2rem 0 0.75rem;
    padding: 0;
    border-bottom: none;
    color: var(--color-text);
  }

  article h5 {
    font-size: 1rem;
    font-weight: 700;
    margin: 1.5rem 0 0.5rem;
    padding: 0;
    border-bottom: none;
    color: var(--color-text-muted);
  }

  /* === Êú¨Êñá„Çπ„Çø„Ç§„É´ === */
  article p {
    margin: 0 0 1.5rem;
    line-height: 1.9;
    color: var(--color-text);
  }

  /* === iframe === */
  article iframe {
    margin: 1.5rem 0;
    border-radius: 8px;
    border: 1px solid var(--color-border);
  }

  /* === ÁîªÂÉè === */
  article img {
    margin: 2rem 0;
    border-radius: 8px;
    border: 1px solid var(--color-border);
    max-width: 100%;
    height: auto;
    transition: opacity 0.2s ease;
  }

  article img:hover {
    opacity: 0.9;
  }

  /* === „É™„Çπ„Éà„Çπ„Çø„Ç§„É´ÔºàulÔºâ === */
  article ul {
    padding: 1rem 1.5rem;
    margin: 1.5rem 0;
    list-style: none;
    background: var(--color-bg-secondary);
    border-radius: 6px;
    border: 1px solid var(--color-border);
  }

  article ul li {
    position: relative;
    padding-left: 1.25rem;
    margin-bottom: 0.5rem;
    line-height: 1.7;
  }

  article ul li:last-child {
    margin-bottom: 0;
  }

  article ul li::before {
    content: "";
    position: absolute;
    left: 0;
    top: 0.6em;
    width: 6px;
    height: 6px;
    background: var(--color-primary);
    border-radius: 50%;
  }

  /* ÁõÆÊ¨°ÂÜÖ„ÅÆÁÆáÊù°Êõ∏„Åç„ÅØ„Éá„Éï„Ç©„É´„Éà„Çπ„Çø„Ç§„É´ */
  .table-of-contents ul {
    list-style: none;
    padding: 0;
    margin: 0;
    background: transparent;
    border: none;
  }

  .table-of-contents ul li {
    padding-left: 0;
    margin-bottom: 0;
  }

  .table-of-contents ul li::before {
    content: none;
  }

  /* blockquoteÂÜÖ„ÅÆÁÆáÊù°Êõ∏„Åç„ÇÇ„Ç∑„É≥„Éó„É´„Å´ */
  article blockquote ul {
    background: transparent;
    border: none;
    padding: 0.5rem 1rem;
  }

  article blockquote ul li {
    padding-left: 1.25rem;
  }

  article blockquote ul li::before {
    background: rgba(var(--color-primary-rgb), 0.5);
  }

  /* === „É™„Çπ„Éà„Çπ„Çø„Ç§„É´ÔºàolÔºâ === */
  article ol {
    padding: 1rem 1.5rem;
    margin: 1.5rem 0;
    list-style: none;
    counter-reset: item;
    background: var(--color-bg-secondary);
    border-radius: 6px;
    border: 1px solid var(--color-border);
  }

  article ol li {
    position: relative;
    padding-left: 2.25rem;
    margin-bottom: 0.75rem;
    counter-increment: item;
    line-height: 1.7;
  }

  article ol li:last-child {
    margin-bottom: 0;
  }

  article ol li::before {
    content: counter(item);
    position: absolute;
    left: 0;
    top: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 1.5rem;
    height: 1.5rem;
    background: var(--color-primary);
    color: var(--color-bg);
    font-weight: 700;
    font-size: 0.8rem;
    border-radius: 4px;
    font-family: var(--font-mono);
  }

  /* === „Ç≥„Éº„Éâ„Éñ„É≠„ÉÉ„ÇØ === */
  article pre {
    margin: 2rem 0;
    border-radius: 8px;
    border: 1px solid var(--color-border);
    overflow-x: auto;
    background: #0d0d0d !important;
    position: relative;
  }

  article pre::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 3px;
    background: var(--color-primary);
    border-radius: 8px 8px 0 0;
  }

  article pre code {
    background: transparent !important;
    font-family: var(--font-mono);
    font-size: 0.875rem;
    line-height: 1.7;
  }

  /* === „Ç§„É≥„É©„Ç§„É≥„Ç≥„Éº„Éâ === */
  article code:not(pre code) {
    background: rgba(var(--color-primary-rgb), 0.1);
    color: var(--color-primary);
    padding: 0.2em 0.4em;
    border-radius: 4px;
    font-size: 0.875em;
    font-family: var(--font-mono);
    border: 1px solid rgba(var(--color-primary-rgb), 0.2);
  }

  /* === ÂºïÁî®ÔºàblockquoteÔºâ === */
  article blockquote {
    background: var(--color-bg-secondary);
    border-left: 4px solid var(--color-primary);
    border-radius: 0 6px 6px 0;
    padding: 1.25rem 1.5rem;
    margin: 2rem 0;
    color: var(--color-text-muted);
    font-style: italic;
    position: relative;
  }

  article blockquote::before {
    content: none;
  }

  article blockquote p {
    margin: 0;
    line-height: 1.7;
  }

  /* === „É™„É≥„ÇØ„Çπ„Çø„Ç§„É´ === */
  article a:not(.link-card) {
    color: var(--color-primary);
    text-decoration: none;
    border-bottom: 1px solid rgba(var(--color-primary-rgb), 0.3);
    transition: border-color 0.2s ease;
  }

  article a:not(.link-card):hover {
    border-bottom-color: var(--color-primary);
  }

  /* === „É™„É≥„ÇØ„Ç´„Éº„Éâ === */
  article .link-card {
    display: flex !important;
    align-items: stretch !important;
    text-decoration: none !important;
    border: 1px solid var(--color-border) !important;
    border-radius: 6px !important;
    overflow: hidden !important;
    margin: 2rem 0 !important;
    background: var(--color-bg-secondary) !important;
    transition: all 0.2s ease !important;
    padding: 0 !important;
    color: inherit !important;
  }

  article .link-card:hover {
    background: var(--color-bg-tertiary) !important;
    border-color: var(--color-border-hover) !important;
  }

  article .link-card .link-card-thumbnail {
    flex-shrink: 0;
    width: 180px;
    min-height: 100px;
    background: var(--color-bg-tertiary);
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
  }

  article .link-card .link-card-thumbnail img {
    width: 100% !important;
    height: 100% !important;
    object-fit: contain !important;
    object-position: center center !important;
    margin: 0 !important;
    border: none !important;
    border-radius: 0 !important;
    padding: 0 !important;
  }

  article .link-card .link-card-thumbnail img:hover {
    opacity: 1 !important;
  }

  article .link-card .link-card-content {
    flex: 1;
    padding: 1rem 1.25rem;
    display: flex;
    flex-direction: column;
    justify-content: center;
    gap: 0.5rem;
    min-width: 0;
  }

  article .link-card .link-card-header {
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }

  article .link-card .link-card-site-name {
    font-size: 0.75rem;
    color: var(--color-text-muted);
    font-weight: 500;
  }

  article .link-card .link-card-title {
    font-size: 0.9rem;
    color: var(--color-text);
    font-weight: 600;
    line-height: 1.5;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
    text-overflow: ellipsis;
    transition: color 0.2s ease;
  }

  article .link-card:hover .link-card-title {
    color: var(--color-primary);
  }

  @media (max-width: 640px) {
    article .link-card {
      flex-direction: column !important;
    }

    article .link-card .link-card-thumbnail {
      width: 100% !important;
      min-height: 160px !important;
      max-height: 180px !important;
    }

    article .link-card .link-card-content {
      padding: 1rem !important;
    }
  }

  /* === „Ç¢„É©„Éº„Éà„Éú„ÉÉ„ÇØ„ÇπÔºàË≠¶Âëä„ÉªÊÉÖÂ†±„Éª„Éí„É≥„Éà„Éª„Éé„Éº„ÉàÔºâ === */
  article p:has(.warning),
  article p:has(.info),
  article p:has(.tip),
  article p:has(.note) {
    display: flex;
    align-items: flex-start;
    gap: 1rem;
    padding: 1rem 1.25rem;
    border-radius: 6px;
    margin: 2rem 0;
    line-height: 1.7;
  }

  article p:has(.warning)::before,
  article p:has(.info)::before,
  article p:has(.tip)::before,
  article p:has(.note)::before {
    flex-shrink: 0;
    font-size: 1.125rem;
    line-height: 1.5;
  }

  article p:has(.warning) {
    background: rgba(234, 179, 8, 0.1);
    border-left: 4px solid #eab308;
  }

  article p:has(.warning)::before {
    content: "‚ö†";
  }

  article p:has(.info) {
    background: rgba(59, 130, 246, 0.1);
    border-left: 4px solid #3b82f6;
  }

  article p:has(.info)::before {
    content: "‚Ñπ";
  }

  article p:has(.tip) {
    background: rgba(var(--color-primary-rgb), 0.1);
    border-left: 4px solid var(--color-primary);
  }

  article p:has(.tip)::before {
    content: "üí°";
  }

  article p:has(.note) {
    background: rgba(168, 85, 247, 0.1);
    border-left: 4px solid #a855f7;
  }

  article p:has(.note)::before {
    content: "üìù";
  }

  article .iframely-embed {
    margin: 2rem 0;
  }

  /* === „ÉÜ„Éº„Éñ„É´ === */
  article table {
    margin: 2rem 0;
    border-radius: 6px;
    overflow: hidden;
    border: 1px solid var(--color-border);
    background: var(--color-bg-secondary);
    width: 100%;
  }

  article th {
    background: var(--color-bg-tertiary);
    padding: 0.875rem 1rem;
    border-bottom: 1px solid var(--color-border);
    font-weight: 700;
    text-align: left;
    color: var(--color-primary);
    font-size: 0.8rem;
    text-transform: uppercase;
    letter-spacing: 0.05em;
  }

  article th::after {
    content: none;
  }

  article td {
    padding: 0.875rem 1rem;
    border-bottom: 1px solid var(--color-border);
    color: var(--color-text);
    font-size: 0.9rem;
  }

  article tbody tr {
    transition: background 0.2s ease;
  }

  article tbody tr::before {
    content: none;
  }

  article tbody tr:hover {
    background: var(--color-bg-tertiary);
  }

  article tbody tr:last-child td {
    border-bottom: none;
  }

  @media (max-width: 768px) {
    article table {
      font-size: 0.85rem;
    }

    article th,
    article td {
      padding: 0.75rem 0.875rem;
    }
  }

  @media (max-width: 480px) {
    article table {
      font-size: 0.8rem;
    }

    article th,
    article td {
      padding: 0.625rem 0.75rem;
    }
  }

  /* === YouTubeÂüã„ÇÅËæº„Åø === */
  .youtube-embed-container {
    position: relative;
    padding-bottom: 56.25%;
    height: 0;
    margin: 2rem 0;
    border-radius: 8px;
    overflow: hidden;
    border: 1px solid var(--color-border);
  }
  
  .youtube-embed-container iframe {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    border: none;
  }

  .youtube-label {
    margin-top: 2rem;
    display: inline-flex;
    align-items: center;
    gap: 0.625rem;
    padding: 0.625rem 1rem;
    background: rgba(255, 0, 0, 0.1);
    border-left: 4px solid #ff0000;
    border-radius: 0 4px 4px 0;
    font-size: 0.875rem;
    font-weight: 600;
    color: var(--color-text);
  }
  
  .youtube-label::before {
    content: "‚ñ∂";
    color: #ff0000;
    font-size: 0.875rem;
  }

  /* Link Card Styles */
  .link-card-wrapper {
    /* @apply my-6; */
  }

  .link-card-container {
    display: block;
    text-decoration: none;
    color: inherit;
    transition: all 0.3s ease;
  }

  .link-card {
    display: flex;
    gap: 1rem;
    padding: 1rem;
    background: rgba(255, 255, 255, 0.03);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 12px;
    overflow: hidden;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    box-shadow:
      0 4px 12px rgba(0, 0, 0, 0.3),
      0 1px 3px rgba(0, 0, 0, 0.2);
  }

  .link-card:hover {
    transform: translateY(-2px);
    border-color: rgba(var(--color-primary-rgb), 0.5);
    background: rgba(255, 255, 255, 0.05);
    box-shadow:
      0 8px 24px rgba(0, 0, 0, 0.4),
      0 2px 6px rgba(var(--color-primary-rgb), 0.3);
  }

  .link-card-thumbnail {
    flex-shrink: 0;
    width: 150px;
    height: 150px;
    border-radius: 8px;
    overflow: hidden;
    background: rgba(0, 0, 0, 0.2);
  }

  .link-card-thumbnail img {
    width: 100%;
    height: 100%;
    object-fit: contain;
    object-position: center center;
    margin: 0 !important;
    box-shadow: none !important;
    border: none !important;
    transition: transform 0.3s ease;
  }

  .link-card:hover .link-card-thumbnail img {
    transform: scale(1.05);
  }

  .link-card-content {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
    min-width: 0;
  }

  .link-card-header {
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }

  .link-card-favicon {
    width: 16px;
    height: 16px;
    flex-shrink: 0;
  }

  .link-card-site-name {
    font-size: 0.75rem;
    color: rgba(255, 255, 255, 0.6);
    font-weight: 500;
  }

  .link-card-title {
    font-size: 1rem;
    font-weight: 600;
    line-height: 1.4;
    margin: 0 !important;
    padding: 0 !important;
    border: none !important;
    overflow: hidden;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
  }

  .link-card-title::before {
    content: none !important;
  }

  .link-card-description {
    font-size: 0.875rem;
    line-height: 1.5;
    color: rgba(255, 255, 255, 0.7);
    overflow: hidden;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
  }

  /* Loading skeleton */
  .link-card-skeleton {
    display: flex;
    gap: 1rem;
    padding: 1rem;
    background: rgba(255, 255, 255, 0.03);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 12px;
  }

  .skeleton-thumbnail {
    width: 150px;
    height: 150px;
    background: linear-gradient(
      90deg,
      rgba(255, 255, 255, 0.05) 0%,
      rgba(255, 255, 255, 0.1) 50%,
      rgba(255, 255, 255, 0.05) 100%
    );
    background-size: 200% 100%;
    animation: skeleton-loading 1.5s ease-in-out infinite;
    border-radius: 8px;
  }

  .skeleton-content {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
  }

  .skeleton-title {
    height: 1.25rem;
    width: 80%;
    background: linear-gradient(
      90deg,
      rgba(255, 255, 255, 0.05) 0%,
      rgba(255, 255, 255, 0.1) 50%,
      rgba(255, 255, 255, 0.05) 100%
    );
    background-size: 200% 100%;
    animation: skeleton-loading 1.5s ease-in-out infinite;
    border-radius: 4px;
  }

  .skeleton-description {
    height: 3rem;
    width: 100%;
    background: linear-gradient(
      90deg,
      rgba(255, 255, 255, 0.05) 0%,
      rgba(255, 255, 255, 0.1) 50%,
      rgba(255, 255, 255, 0.05) 100%
    );
    background-size: 200% 100%;
    animation: skeleton-loading 1.5s ease-in-out infinite;
    border-radius: 4px;
  }

  .skeleton-site {
    height: 0.875rem;
    width: 40%;
    background: linear-gradient(
      90deg,
      rgba(255, 255, 255, 0.05) 0%,
      rgba(255, 255, 255, 0.1) 50%,
      rgba(255, 255, 255, 0.05) 100%
    );
    background-size: 200% 100%;
    animation: skeleton-loading 1.5s ease-in-out infinite;
    border-radius: 4px;
  }

  @keyframes skeleton-loading {
    0% {
      background-position: 200% 0;
    }
    100% {
      background-position: -200% 0;
    }
  }

  /* Fallback styles */
  .link-card-fallback {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 1rem;
    background: rgba(255, 255, 255, 0.03);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 12px;
    transition: all 0.3s ease;
  }

  .link-card-fallback:hover {
    background: rgba(255, 255, 255, 0.05);
    border-color: rgba(var(--color-primary-rgb), 0.4);
  }

  .fallback-icon {
    font-size: 1.5rem;
  }

  .fallback-url {
    font-size: 0.875rem;
    color: var(--color-primary);
    word-break: break-all;
  }

  /* Responsive styles */
  @media (max-width: 640px) {
    .link-card {
      flex-direction: column;
    }

    .link-card-thumbnail {
      width: 100%;
      height: 200px;
    }
  }
</style>

<style>
  .blog-detail-wrapper {
    min-height: 100vh;
    width: 100%;
    display: grid;
    grid-template:
      "blog-detail-header blog-detail-header blog-detail-header" auto
      "center center right " 1fr
      "footer footer footer" 100px
      / auto 1fr 320px;
    grid-gap: 10px 80px;
  }

  .blog-detail-header {
    grid-area: blog-detail-header;
  }

  .main {
    grid-area: center;
  }

  nav {
    grid-area: left;
  }

  aside {
    grid-area: right;
    position: sticky;
    top: 120px;
    align-self: start;
    max-height: calc(100vh - 140px);
    overflow-y: auto;
    display: flex;
    flex-direction: column;
    gap: 2rem;
  }

  /* „Çπ„ÇØ„É≠„Éº„É´„Éê„Éº„ÅÆ„Çπ„Çø„Ç§„É™„É≥„Ç∞ÔºàasideÁî®Ôºâ */
  aside::-webkit-scrollbar {
    width: 4px;
  }

  aside::-webkit-scrollbar-track {
    background: transparent;
  }

  aside::-webkit-scrollbar-thumb {
    background: rgba(var(--color-primary-rgb), 0.3);
    border-radius: 2px;
  }

  aside::-webkit-scrollbar-thumb:hover {
    background: rgba(var(--color-primary-rgb), 0.5);
  }

  .footer {
    grid-area: footer;
  }

  /* === „Ç¢„Ç§„Ç≠„É£„ÉÉ„ÉÅÁîªÂÉè === */
  .article-eyecatch {
    margin-bottom: 2.5rem;
    border-radius: 8px;
    overflow: hidden;
    border: 1px solid var(--color-border);
  }

  .eyecatch-image {
    width: 100%;
    height: auto;
    display: block;
    margin: 0 !important;
    border: none !important;
    border-radius: 0 !important;
  }

  /* === Ë®ò‰∫ã„Éò„ÉÉ„ÉÄ„Éº === */
  .article-header {
    margin-bottom: 3rem;
    padding-bottom: 2rem;
  }

  .article-categories {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    margin-bottom: 1.25rem;
  }

  .article-category-badge {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.375rem 0.875rem;
    background: rgba(var(--color-primary-rgb), 0.1);
    border: 1px solid rgba(var(--color-primary-rgb), 0.25);
    border-radius: 4px;
    font-size: 0.75rem;
    font-weight: 600;
    color: var(--color-primary);
    text-transform: uppercase;
    letter-spacing: 0.05em;
    transition: all 0.2s ease;
    text-decoration: none;
  }

  .article-category-badge:hover {
    background: rgba(var(--color-primary-rgb), 0.2);
    border-color: rgba(var(--color-primary-rgb), 0.5);
    color: var(--color-primary);
  }

  .category-dot {
    width: 6px;
    height: 6px;
    background: var(--color-primary);
    border-radius: 50%;
  }

  .article-meta {
    display: flex;
    align-items: center;
    gap: 1rem;
    flex-wrap: wrap;
    margin-top: 1.5rem;
  }

  .article-meta .meta-item {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 0.875rem;
    color: var(--color-text-muted);
  }

  .meta-icon-wrapper {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 28px;
    height: 28px;
    background: rgba(var(--color-primary-rgb), 0.1);
    border-radius: 4px;
  }

  .article-meta .meta-icon {
    width: 16px;
    height: 16px;
    color: var(--color-primary);
  }

  .meta-label {
    font-size: 0.75rem;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    color: var(--color-text-muted);
  }

  .meta-value {
    font-family: var(--font-mono);
    font-size: 0.875rem;
    color: var(--color-text);
  }

  .meta-divider {
    color: var(--color-border);
  }

  .article-header-line {
    margin-top: 2rem;
    height: 1px;
    background: linear-gradient(
      to right,
      var(--color-primary),
      rgba(var(--color-primary-rgb), 0.3),
      transparent
    );
  }

  /* === Ë®ò‰∫ãÊúÄÂæå„ÅÆ„Çª„ÇØ„Ç∑„Éß„É≥ === */
  .article-footer-sections {
    margin-top: 5rem;
    display: flex;
    flex-direction: column;
    gap: 3rem;
  }

  .share-section,
  .related-posts-section,
  .author-section {
    padding: 2rem;
    background: var(--color-bg-secondary);
    border-radius: 8px;
    border: 1px solid var(--color-border);
  }

  .section-header {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    margin-bottom: 1.5rem;
    padding-bottom: 1rem;
    border-bottom: 1px solid var(--color-border);
  }

  .section-header-icon {
    width: 24px;
    height: 24px;
    color: var(--color-primary);
  }

  .section-title {
    font-family: var(--font-mono);
    font-size: 0.875rem;
    font-weight: 700;
    color: var(--color-primary);
    letter-spacing: 0.1em;
    margin: 0;
    padding: 0;
    border: none;
  }

  .section-subtitle {
    font-size: 0.875rem;
    color: var(--color-text-muted);
    margin-left: auto;
  }

  /* === „Ç∑„Çß„Ç¢„Éú„Çø„É≥ === */
  .share-buttons {
    display: flex;
    flex-wrap: wrap;
    gap: 0.75rem;
  }

  .share-button {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.625rem 1rem;
    background: var(--color-bg-tertiary);
    border: 1px solid var(--color-border);
    border-radius: 4px;
    color: var(--color-text);
    font-size: 0.8rem;
    font-weight: 500;
    text-decoration: none;
    transition: all 0.2s ease;
  }

  .share-button:hover {
    border-color: currentColor;
    color: currentColor;
  }

  .share-icon {
    width: 18px;
    height: 18px;
  }

  .share-label {
    font-family: var(--font-mono);
    font-size: 0.75rem;
  }

  .share-x:hover { color: #ffffff; background: #000000; }
  .share-hatena:hover { color: #00A4DE; }
  .share-facebook:hover { color: #1877F2; }
  .share-line:hover { color: #00C300; }
  .share-linkedin:hover { color: #0A66C2; }
  .share-pocket:hover { color: #EF4056; }

  /* === Èñ¢ÈÄ£Ë®ò‰∫ã === */
  .related-posts-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 1rem;
  }

  .related-post-card {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 1rem;
    padding: 1.25rem;
    background: var(--color-bg-tertiary);
    border: 1px solid var(--color-border);
    border-radius: 4px;
    text-decoration: none;
    color: inherit;
    transition: all 0.2s ease;
  }

  .related-post-card:hover {
    border-color: var(--color-border-hover);
    background: var(--color-bg-secondary);
  }

  .related-post-card:hover .related-post-title {
    color: var(--color-primary);
  }

  .related-post-card:hover .related-post-arrow {
    opacity: 1;
    transform: translateX(4px);
  }

  .related-post-content {
    flex: 1;
    min-width: 0;
  }

  .related-post-categories {
    display: flex;
    gap: 0.5rem;
    margin-bottom: 0.625rem;
  }

  .related-post-category {
    font-size: 0.625rem;
    font-weight: 600;
    color: var(--color-primary);
    text-transform: uppercase;
    letter-spacing: 0.05em;
    background: rgba(var(--color-primary-rgb), 0.1);
    padding: 0.2rem 0.5rem;
    border-radius: 2px;
  }

  .related-post-title {
    font-size: 0.9rem;
    font-weight: 600;
    line-height: 1.5;
    color: var(--color-text);
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
    margin-bottom: 0.5rem;
    transition: color 0.2s ease;
  }

  .related-post-meta {
    display: flex;
    align-items: center;
    gap: 0.375rem;
    font-size: 0.75rem;
    color: var(--color-text-muted);
    font-family: var(--font-mono);
  }

  .related-meta-icon {
    width: 14px;
    height: 14px;
    color: var(--color-primary);
  }

  .related-post-arrow {
    flex-shrink: 0;
    opacity: 0.3;
    transition: all 0.2s ease;
  }

  .arrow-icon {
    width: 20px;
    height: 20px;
    color: var(--color-primary);
  }

  /* === ÁõÆÊ¨°„Ç®„É™„Ç¢Ôºà„É¢„Éê„Ç§„É´Ôºâ === */
  .toc-mobile {
    display: block;
  }

  @media (min-width: 1025px) {
    .toc-mobile {
      display: none;
    }
  }

  /* === „É¨„Çπ„Éù„É≥„Ç∑„Éñ === */
  @media (max-width: 1024px) {
    .blog-detail-wrapper {
      grid-template:
        "blog-detail-header blog-detail-header blog-detail-header" auto
        "center center center " 1fr
        "right  right  right " auto
        / 1fr;
      grid-gap: 10px 0;
    }

    aside {
      display: none;
    }

    .toc-mobile {
      display: block;
    }

    .related-posts-grid {
      grid-template-columns: 1fr;
    }
  }

  @media (max-width: 640px) {
    .article-header {
      margin-bottom: 2rem;
    }

    .article-meta {
      flex-direction: column;
      align-items: flex-start;
      gap: 0.75rem;
    }

    .meta-divider {
      display: none;
    }

    .share-section,
    .related-posts-section,
    .author-section {
      padding: 1.5rem;
    }

    .share-buttons {
      gap: 0.5rem;
    }

    .share-button {
      padding: 0.5rem 0.75rem;
    }

    .share-label {
      display: none;
    }

    .section-subtitle {
      display: none;
    }
  }
</style>
