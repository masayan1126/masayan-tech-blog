---
import FormattedDate from "@/components/FormattedDate.astro";
import "@fontsource-variable/noto-sans-jp";
import BaseLayout from "@/layouts/BaseLayout.astro";
import { getArticlesByCategory } from "@/libs/microcms/blog";
import Link from "@/components/Link/Link.astro";
import buildFilter from "@/libs/microcms/buildFilter";
import { Icon } from "astro-icon";
import { BlogListLink } from "@/features/Blog/List/BlogListLink";
import BlogDetailProfileCard from "@/features/Blog/Detail/BlogDetailProfileCard.astro";
import { SITE_DOMAIN } from "@/constants/url";
import { ARTICLES_PATH } from "@/features/Blog/List/constants/path";
import type { Article } from "@/libs/microcms/blog";
import ScrollToTop from "@/components/ScrollToTop.astro";
import { LinkCardReplacer } from "@/features/LinkCard/LinkCardReplacer";

type Props = Article;

const { title, description, publishedAt, revisedAt, category, youtube_link } = Astro.props;
const { slug } = Astro.params;




const catetoryIds = category.map(({ id }) => id);
const filter = buildFilter("categoryId", catetoryIds);
const relatedPostsRes = await getArticlesByCategory(filter);
const relatedRandomPosts = [...relatedPostsRes.contents].sort(() => {
  return Math.random() - 0.5;
});

console.log(youtube_link);

// YouTube URL„Åã„ÇâVideo ID„ÇíÊäΩÂá∫
function extractVideoId(youtubeUrl: string): string | null {
  const patterns = [
    /(?:youtube\.com\/watch\?v=|youtu\.be\/)([^&\s]+)/,
    /youtube\.com\/embed\/([^?&\s]+)/,
  ];

  for (const pattern of patterns) {
    const match = youtubeUrl.match(pattern);
    if (match && match[1]) {
      return match[1];
    }
  }

  return null;
}

// VideoObjectÊßãÈÄ†Âåñ„Éá„Éº„Çø„ÇíÁîüÊàê
let videoStructuredData = null;
if (youtube_link) {
  const videoId = extractVideoId(youtube_link);
  if (videoId) {
    videoStructuredData = {
      "@context": "https://schema.org",
      "@type": "VideoObject",
      "name": title,
      "description": description || title,
      "thumbnailUrl": `https://i.ytimg.com/vi/${videoId}/maxresdefault.jpg`,
      "uploadDate": publishedAt,
      "contentUrl": `https://www.youtube.com/watch?v=${videoId}`,
      "embedUrl": `https://www.youtube.com/embed/${videoId}`,
    };
  }
}

const breadCrumbsList = [
  {
    name: "„Éõ„Éº„É†",
    path: `/`,
  },
  {
    name: "„Éñ„É≠„Ç∞Ë®ò‰∫ã‰∏ÄË¶ß",
    path: ARTICLES_PATH,
  },
  {
    name: title,
    path: `/blog/${slug}/`,
  },
];
---

<BaseLayout
  {title}
  {description}
  context={"blog"}
  {breadCrumbsList}
>
  {videoStructuredData && (
    <Fragment slot="head">
      <script type="application/ld+json" is:inline set:html={JSON.stringify(videoStructuredData)} />
    </Fragment>
  )}
  <div class="blog-detail-wrapper">
    <div class="main">
      <div class="blog-detail-header">
        <h1 class="article-title">
          {title}
        </h1>

        <div class="flex flex-col gap-2">
          <div>
            <Icon name="noto:calendar" class="w-5 h-5 mr-1 inline-block align-middle" style="color: var(--color-primary);" />
            ÂÖ¨ÈñãÊó•
            <FormattedDate date={new Date(publishedAt)} />
          </div>
          <div>
            <Icon name="noto:pen" class="w-5 h-5 mr-1 inline-block align-middle text-green-300" />
            ÊúÄÁµÇÊõ¥Êñ∞Êó•
            <FormattedDate date={new Date(revisedAt)} />
          </div>
        </div>

        <!-- „Ç´„ÉÜ„Ç¥„É™Ë°®Á§∫ -->
        <div class="category-section mt-4">
          <div class="flex flex-wrap gap-2">
            {category.map(({ id, name }) => (
              <a
                href={`/category/${id}${ARTICLES_PATH}`}
                class="inline-block px-3 py-1 rounded-lg text-sm text-white transition-all duration-200 hover:scale-105"
                style="background-color: rgba(var(--color-primary-rgb), 0.2); border: 1px solid rgba(var(--color-primary-rgb), 0.4);"
                onmouseover="this.style.backgroundColor='rgba(var(--color-primary-rgb), 0.3)'; this.style.borderColor='rgba(var(--color-primary-rgb), 0.6)';"
                onmouseout="this.style.backgroundColor='rgba(var(--color-primary-rgb), 0.2)'; this.style.borderColor='rgba(var(--color-primary-rgb), 0.4)';"
              >
                {name}
              </a>
            ))}
          </div>
        </div>
      </div>
      {youtube_link && (
        <>
          <p class="youtube-label">„Åì„ÅÆÂÜÖÂÆπ„ÅØYOUTUBEÂãïÁîª„Åß„ÇÇ„ÅîË¶ß„ÅÑ„Åü„Å†„Åë„Åæ„Åô</p>
          <div class="youtube-embed-container mt-8">
            <iframe
              width="100%"
              height="315"
              src={youtube_link.replace('watch?v=', 'embed/')}
              title="YouTube video player"
              frameborder="0"
              allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
              allowfullscreen
            ></iframe>
          </div>
        </>
      )}
      <!-- „É¢„Éê„Ç§„É´Ë°®Á§∫Áî®„ÅÆÁõÆÊ¨° -->
      <div class="toc-mobile">
        <slot name="toc-mobile" />
      </div>
      <article>
        <slot />
      </article>

      <!-- Ë®ò‰∫ãÊúÄÂæå„ÅÆ„Çª„ÇØ„Ç∑„Éß„É≥ -->
      <div class="article-footer-sections">
        <!-- „Åì„ÅÆË®ò‰∫ã„Çí„Ç∑„Çß„Ç¢„Åô„Çã -->
        <div class="share-section">
          <h2 class="section-title">„Åì„ÅÆË®ò‰∫ã„Çí„Ç∑„Çß„Ç¢„Åô„Çã</h2>
          <div class="flex flex-wrap gap-2">
            <a
              href={`http://twitter.com/share?url=${SITE_DOMAIN}/blog/${slug}&via=masayanishigaki&text=${title}`}
              target="_blank"
              rel="noopener noreferrer"
              class="text-black hover:text-gray-700 transition-colors"
            >
              <svg class="w-8 inline-block mr-2" viewBox="0 0 24 24" fill="currentColor">
                <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
              </svg>
            </a>
            <a
              href={`http://b.hatena.ne.jp/add?mode=confirm&url=${SITE_DOMAIN}/blog/${slug}&title=${title}`}
              target="_blank"
              rel="noopener noreferrer"
              style="color: #00A4DE;"
              class="hover:opacity-80 transition-opacity"
            >
              <Icon
                name="simple-icons:hatenabookmark"
                class="w-8 inline-block mr-2"
              />
            </a>
            <a
              href={`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(`${SITE_DOMAIN}/blog/${slug}`)}`}
              target="_blank"
              rel="noopener noreferrer"
              style="color: #1877F2;"
              class="hover:opacity-80 transition-opacity"
            >
              <Icon
                name="simple-icons:facebook"
                class="w-8 inline-block mr-2"
              />
            </a>
            <a
              href={`https://social-plugins.line.me/lineit/share?url=${encodeURIComponent(`${SITE_DOMAIN}/blog/${slug}`)}`}
              target="_blank"
              rel="noopener noreferrer"
              style="color: #00C300;"
              class="hover:opacity-80 transition-opacity"
            >
              <Icon
                name="simple-icons:line"
                class="w-8 inline-block mr-2"
              />
            </a>
            <a
              href={`https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(`${SITE_DOMAIN}/blog/${slug}`)}`}
              target="_blank"
              rel="noopener noreferrer"
              style="color: #0A66C2;"
              class="hover:opacity-80 transition-opacity"
            >
              <Icon
                name="simple-icons:linkedin"
                class="w-8 inline-block mr-2"
              />
            </a>
            <a
              href={`https://getpocket.com/save?url=${encodeURIComponent(`${SITE_DOMAIN}/blog/${slug}`)}&title=${encodeURIComponent(title)}`}
              target="_blank"
              rel="noopener noreferrer"
              style="color: #EF4056;"
              class="hover:opacity-80 transition-opacity"
            >
              <Icon
                name="simple-icons:pocket"
                class="w-8 inline-block mr-2"
              />
            </a>
          </div>
        </div>

        <!-- Èñ¢ÈÄ£Ë®ò‰∫ã -->
        <div class="related-posts-section">
          <h2 class="section-title">Èñ¢ÈÄ£Ë®ò‰∫ã</h2>
          <div class="gap-10 grid grid-cols-1">
            {
              relatedRandomPosts.map(
                (post, i) =>
                  i < 16 && (
                    <div>
                      <p class={"mb-2"}>
                        <Link href={`/blog/${post.id}`} color="white">
                          {post.title}
                        </Link>
                      </p>
                      <div class="flex flex-wrap gap-1 mb-2">
                        {post.category.map((c) => (
                          <a
                            href={`/category/${c.id}${ARTICLES_PATH}`}
                            class="inline-block px-2 py-1 rounded text-xs text-white transition-all duration-200 hover:scale-105"
                            style="background-color: rgba(var(--color-primary-rgb), 0.2); border: 1px solid rgba(var(--color-primary-rgb), 0.4);"
                            onmouseover="this.style.backgroundColor='rgba(var(--color-primary-rgb), 0.3)'; this.style.borderColor='rgba(var(--color-primary-rgb), 0.6)';"
                            onmouseout="this.style.backgroundColor='rgba(var(--color-primary-rgb), 0.2)'; this.style.borderColor='rgba(var(--color-primary-rgb), 0.4)';"
                          >
                            {c.name}
                          </a>
                        ))}
                      </div>
                      <p class="mt-2 text-sm">
                        <FormattedDate date={new Date(post.publishedAt)} />
                      </p>
                      <div class="mt-3">
                        <a
                          href={`/blog/${post.id}/`}
                          class="inline-flex items-center gap-2 text-white hover:opacity-75 transition-all duration-200 hover:gap-3"
                        >
                          <svg class="w-5 h-5" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M21,5C19.89,4.65 18.67,4.5 17.5,4.5C15.55,4.5 13.45,4.9 12,6C10.55,4.9 8.45,4.5 6.5,4.5C4.55,4.5 2.45,4.9 1,6V20.65C1,20.9 1.25,21.15 1.5,21.15C1.6,21.15 1.65,21.1 1.75,21.1C3.1,20.45 5.05,20 6.5,20C8.45,20 10.55,20.4 12,21.5C13.35,20.65 15.8,20 17.5,20C19.15,20 20.85,20.3 22.25,21.05C22.35,21.1 22.4,21.1 22.5,21.1C22.75,21.1 23,20.85 23,20.6V6C22.4,5.55 21.75,5.25 21,5M21,18.5C19.9,18.15 18.7,18 17.5,18C15.8,18 13.35,18.65 12,19.5V8C13.35,7.15 15.8,6.5 17.5,6.5C18.7,6.5 19.9,6.65 21,7V18.5Z"/>
                          </svg>
                          <span>„Åì„ÅÆË®ò‰∫ã„ÇíË™≠„ÇÄ</span>
                          <svg class="w-4 h-4" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z"/>
                          </svg>
                        </a>
                      </div>
                    </div>
                  )
              )
            }
          </div>
        </div>

        <!-- „Éñ„É≠„Ç∞ÁÆ°ÁêÜ‰∫∫ -->
        <div class="profile-section">
          <h2 class="section-title">„Éñ„É≠„Ç∞ÁÆ°ÁêÜ‰∫∫</h2>
          <BlogDetailProfileCard />
        </div>
      </div>

      <LinkCardReplacer client:load />
      <ScrollToTop />
    </div>
    <aside>
      <!-- PCË°®Á§∫Áî®„ÅÆÁõÆÊ¨°Ôºà„Çπ„ÉÜ„Ç£„ÉÉ„Ç≠„ÉºÔºâ -->
      <slot name="toc-desktop" />
    </aside>
  </div>
</BaseLayout>
<!-- MEMO:ÂãïÁöÑ„Å´ÂèñÂæó„Åó„ÅüË®ò‰∫ã„ÅÆ„Çø„Ç∞„Å´„Çπ„Çø„Ç§„É´„ÇíÂΩì„Å¶„Çã„Å´„ÅØ„ÄÅgloba„Å´„Åô„ÇãÂøÖË¶Å„Åå„ÅÇ„Çã -->
<style is:global>
  article {
    width: 100%;
    overflow-x: scroll;
  }

  article h1::before {
    content: "üî•";
  }

  .article-title {
    font-size: 2rem;
    font-weight: 700;
    margin-bottom: 1.5rem;
    display: inline-block;
    color: #ffffff;
    letter-spacing: -0.02em;
    line-height: 1.3;
    padding: 0.75rem 0;
    position: relative;
  }

  .article-title::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    width: 60px;
    height: 3px;
    background: var(--color-primary);
  }

  /* „É¢„Éê„Ç§„É´ÂØæÂøú */
  @media (max-width: 768px) {
    .article-title {
      font-size: 1.75rem;
      letter-spacing: -0.01em;
      padding: 0.5rem 0;
      margin-bottom: 1.25rem;
    }
    
    .article-title::after {
      width: 40px;
      height: 2px;
    }
  }

  @media (max-width: 480px) {
    .article-title {
      font-size: 1.5rem;
      line-height: 1.4;
      margin-bottom: 1rem;
    }
    
    .article-title::after {
      width: 30px;
    }
  }

  .toc-title {
    @apply text-2xl font-bold mt-4 mb-2;
  }

  .toc-title::before {
    content: "üöÄ";
    padding-right: 5px;
  }

  article h2 {
    @apply text-2xl font-bold mt-14 mb-2;
    border-bottom: 1px solid var(--border-color);
    padding-bottom: 8px;
  }

  article h2::before {
    content: '';
    display: inline-block;
    width: 1.5rem;
    height: 1.5rem;
    background-image: url('/miyabiya.png');
    background-size: cover;
    background-position: center;
    border-radius: 50%;
    margin-right: 0.5rem;
    vertical-align: middle;
  }

  article h3 {
    @apply text-lg font-bold mt-8 mb-2;
    border-bottom: 1px solid var(--border-color);
    padding-bottom: 8px;
  }

  article h4 {
    @apply font-bold mt-8 mb-2;
    border-bottom: 1px solid var(--border-color);
    padding-bottom: 8px;
  }

  article h5 {
    @apply font-bold mt-8 mb-2;
    border-bottom: 1px solid var(--border-color);
    padding-bottom: 8px;
  }

  article p {
    @apply m-0;
  }

  article iframe {
    @apply mt-2;
    border-radius: 12px;
    box-shadow: 
      0 8px 24px rgba(0, 0, 0, 0.4),
      0 2px 6px rgba(0, 0, 0, 0.3);
    border: 1px solid rgba(255, 255, 255, 0.1);
  }

  article img {
    @apply my-6;
    border-radius: 12px;
    box-shadow: 
      0 10px 30px rgba(0, 0, 0, 0.5),
      0 1px 8px rgba(0, 0, 0, 0.3),
      inset 0 1px 0 rgba(255, 255, 255, 0.1);
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    border: 1px solid rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(10px);
    max-width: 100%;
    height: auto;
  }

  article img:hover {
    transform: translateY(-4px) scale(1.02);
    box-shadow: 
      0 20px 40px rgba(0, 0, 0, 0.6),
      0 4px 12px rgba(0, 0, 0, 0.4),
      inset 0 1px 0 rgba(255, 255, 255, 0.15);
  }

  article ul {
    @apply px-8 py-4;
    list-style: none;
  }

  article ul li {
    position: relative;
    padding-left: 1.5rem;
    margin-bottom: 0.5rem;
  }

  article ul li::before {
    content: "‚úì";
    position: absolute;
    left: 0;
    color: var(--color-primary);
    font-weight: bold;
    font-size: 1.1rem;
  }

  /* ÁõÆÊ¨°ÂÜÖ„ÅÆÁÆáÊù°Êõ∏„Åç„ÅØ„ÉÅ„Çß„ÉÉ„ÇØ„Éû„Éº„ÇØ„ÇíË°®Á§∫„Åó„Å™„ÅÑ */
  .table-of-contents ul {
    list-style: disc;
  }

  .table-of-contents ul li {
    padding-left: 0;
  }

  .table-of-contents ul li::before {
    content: none;
  }

  /* blockquoteÂÜÖ„ÅÆÁÆáÊù°Êõ∏„Åç„ÇÇ„ÉÅ„Çß„ÉÉ„ÇØ„Éû„Éº„ÇØ„ÇíË°®Á§∫„Åó„Å™„ÅÑ */
  article blockquote ul {
    list-style: disc;
  }

  article blockquote ul li {
    padding-left: 0;
  }

  article blockquote ul li::before {
    content: none;
  }

  article ol {
    @apply px-8 py-4;
    list-style: none;
    counter-reset: item;
  }

  article ol li {
    position: relative;
    padding-left: 2.5rem;
    margin-bottom: 1rem;
    counter-increment: item;
  }

  article ol li::before {
    content: counter(item);
    position: absolute;
    left: 0;
    top: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 1.75rem;
    height: 1.75rem;
    background: linear-gradient(135deg, var(--color-primary), #FFC857);
    color: #1a1a1a;
    font-weight: bold;
    font-size: 0.9rem;
    border-radius: 50%;
    box-shadow: 0 2px 8px rgba(var(--color-primary-rgb), 0.4);
  }

  article pre {
    @apply mt-6 mb-10;
    border-radius: 12px;
    box-shadow: 
      0 8px 24px rgba(0, 0, 0, 0.4),
      0 2px 6px rgba(0, 0, 0, 0.3);
    border: 1px solid rgba(80, 80, 80, 0.3);
    transition: all 0.3s ease;
    overflow-x: auto;
    background: linear-gradient(135deg, #0d0d0d 0%, #1a1a1a 100%) !important;
  }

  article pre code {
    background: transparent !important;
  }

  /* „Ç§„É≥„É©„Ç§„É≥„Ç≥„Éº„Éâ„ÅÆ„Çπ„Çø„Ç§„É´ */
  article code:not(pre code) {
    background: rgba(var(--color-secondary-rgb), 0.2);
    color: #ffffff;
    padding: 0.2em 0.4em;
    border-radius: 4px;
    font-size: 0.9em;
    font-family: 'Courier New', Courier, monospace;
    border: 1px solid rgba(var(--color-secondary-rgb), 0.3);
  }

  /* blockquote„ÅÆ„Çπ„Çø„Ç§„É´ */
  article blockquote {
    background: rgba(var(--color-secondary-rgb), 0.15);
    border-left: 4px solid rgba(var(--color-secondary-rgb), 0.6);
    border-radius: 8px;
    padding: 1.5rem 1.5rem 1.5rem 1.75rem;
    margin: 1.5rem 0;
    color: #d1cfcf;
    font-style: italic;
    position: relative;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
  }

  article blockquote::before {
    content: '"';
    position: absolute;
    left: 1rem;
    top: 0.5rem;
    font-size: 2rem;
    color: rgba(var(--color-secondary-rgb), 0.4);
    font-family: Georgia, serif;
  }

  article pre:hover {
    box-shadow: 
      0 12px 32px rgba(0, 0, 0, 0.5),
      0 4px 8px rgba(0, 0, 0, 0.4);
    transform: translateY(-2px);
    border-color: rgba(100, 100, 100, 0.4);
  }

  /* Normal links (excluding link cards) */
  article a:not(.link-card) {
    color: var(--color-primary);
    padding: 10px 0;
  }

  /* Link Card Styles - supports both <a> and <span> */
  article .link-card {
    display: flex !important;
    align-items: stretch !important;
    text-decoration: none !important;
    border: 1px solid rgba(255, 255, 255, 0.1) !important;
    border-radius: 12px !important;
    overflow: hidden !important;
    margin: 1.5rem 0 !important;
    background: rgba(255, 255, 255, 0.02) !important;
    transition: all 0.3s ease !important;
    box-shadow:
      0 4px 12px rgba(0, 0, 0, 0.3),
      0 1px 3px rgba(0, 0, 0, 0.2) !important;
    padding: 0 !important;
    color: inherit !important;
  }

  article .link-card:hover {
    background: rgba(255, 255, 255, 0.05) !important;
    border-color: rgba(var(--color-primary-rgb), 0.5) !important;
    transform: translateY(-2px) !important;
    box-shadow:
      0 8px 24px rgba(0, 0, 0, 0.4),
      0 2px 6px rgba(var(--color-primary-rgb), 0.3) !important;
  }

  article .link-card .link-card-thumbnail {
    flex-shrink: 0;
    width: 200px;
    min-height: 120px;
    background: rgba(0, 0, 0, 0.2);
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
  }

  article .link-card .link-card-thumbnail img {
    width: 100% !important;
    height: 100% !important;
    object-fit: contain !important;
    object-position: center center !important;
    margin: 0 !important;
    box-shadow: none !important;
    border-radius: 0 !important;
    padding: 0 !important;
  }

  article .link-card .link-card-thumbnail img:hover {
    transform: none !important;
    box-shadow: none !important;
  }

  article .link-card .link-card-content {
    flex: 1;
    padding: 1.25rem 1.5rem;
    display: flex;
    flex-direction: column;
    justify-content: center;
    gap: 0.75rem;
    min-width: 0;
  }

  article .link-card .link-card-header {
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }

  article .link-card .link-card-site-name {
    font-size: 0.875rem;
    color: rgba(255, 255, 255, 0.6);
    font-weight: 500;
  }

  article .link-card .link-card-title {
    font-size: 1rem;
    color: var(--color-primary);
    font-weight: 600;
    line-height: 1.5;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  /* Mobile Responsive */
  @media (max-width: 640px) {
    article .link-card {
      flex-direction: column !important;
    }

    article .link-card .link-card-thumbnail {
      width: 100% !important;
      min-height: 180px !important;
      max-height: 200px !important;
    }

    article .link-card .link-card-content {
      padding: 1.25rem !important;
    }
  }

  article p:has(.warning) {
    background: rgba(255, 193, 7, 0.1);
    border: 1px solid rgba(255, 193, 7, 0.3);
    padding: 1.5rem 1.5rem 1.5rem 3.5rem;
    border-radius: 8px;
    position: relative;
    margin: 1.5rem 0;
  }

  article p:has(.warning)::before {
    content: "‚ö†Ô∏è";
    position: absolute;
    left: 1.2rem;
    top: 50%;
    transform: translateY(-50%);
    font-size: 1.2rem;
  }

  article p:has(.info) {
    background: rgba(var(--color-secondary-rgb), 0.15);
    border: 1px solid rgba(var(--color-secondary-rgb), 0.4);
    padding: 1.5rem 1.5rem 1.5rem 3.5rem;
    border-radius: 8px;
    position: relative;
    margin: 1.5rem 0;
  }

  article p:has(.info)::before {
    content: "‚ÑπÔ∏è";
    position: absolute;
    left: 1.2rem;
    top: 50%;
    transform: translateY(-50%);
    font-size: 1.2rem;
  }

  article p:has(.tip) {
    background: rgba(var(--color-primary-rgb), 0.15);
    border: 1px solid rgba(var(--color-primary-rgb), 0.4);
    padding: 1.5rem 1.5rem 1.5rem 3.5rem;
    border-radius: 8px;
    position: relative;
    margin: 1.5rem 0;
  }

  article p:has(.tip)::before {
    content: "üí°";
    position: absolute;
    left: 1.2rem;
    top: 50%;
    transform: translateY(-50%);
    font-size: 1.2rem;
  }

  article p:has(.note) {
    background: rgba(156, 39, 176, 0.12);
    border: 1px solid rgba(156, 39, 176, 0.3);
    padding: 1.5rem 1.5rem 1.5rem 3.5rem;
    border-radius: 8px;
    position: relative;
    margin: 1.5rem 0;
  }

  article p:has(.note)::before {
    content: "üìù";
    position: absolute;
    left: 1.2rem;
    top: 50%;
    transform: translateY(-50%);
    font-size: 1.2rem;
  }

  article .iframely-embed {
    @apply my-6;
  }

  article table {
    @apply my-6;
    border-radius: 16px;
    overflow: hidden;
    box-shadow: 
      0 10px 40px rgba(0, 0, 0, 0.5),
      0 2px 8px rgba(0, 0, 0, 0.3),
      inset 0 1px 0 rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(80, 80, 80, 0.4);
    background: linear-gradient(135deg, rgba(25, 25, 25, 0.95), rgba(35, 35, 35, 0.95));
    backdrop-filter: blur(10px);
  }

  article th {
    background: rgba(40, 40, 40, 0.9);
    padding: 1.125rem 1.25rem;
    border-bottom: 2px solid rgba(100, 100, 100, 0.5);
    font-weight: 700;
    text-align: left;
    color: #e0e0e0;
    letter-spacing: 0.03em;
    font-size: 0.95rem;
    text-transform: uppercase;
    position: relative;
  }

  article th::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    height: 2px;
    background: linear-gradient(90deg, 
      transparent,
      rgba(100, 100, 100, 0.4) 20%,
      rgba(100, 100, 100, 0.4) 80%,
      transparent
    );
  }

  article td {
    padding: 1rem 1.25rem;
    border-bottom: 1px solid rgba(80, 80, 80, 0.3);
    color: #d1cfcf;
    font-size: 0.95rem;
    transition: all 0.2s ease;
    position: relative;
  }

  article tbody tr {
    transition: all 0.3s ease;
    position: relative;
  }

  article tbody tr::before {
    content: '';
    position: absolute;
    left: 0;
    top: 0;
    bottom: 0;
    width: 3px;
    background: linear-gradient(180deg, 
      rgba(100, 100, 100, 0.6), 
      rgba(100, 100, 100, 0.3)
    );
    opacity: 0;
    transition: opacity 0.3s ease;
  }

  article tbody tr:hover {
    background: linear-gradient(90deg, 
      rgba(40, 40, 40, 0.8), 
      rgba(45, 45, 45, 0.8)
    );
    transform: translateX(2px);
  }

  article tbody tr:hover::before {
    opacity: 1;
  }

  article tbody tr:last-child td {
    border-bottom: none;
  }

  /* „ÉÜ„Éº„Éñ„É´„ÅÆ„É¨„Çπ„Éù„É≥„Ç∑„ÉñÂØæÂøú */
  @media (max-width: 768px) {
    article table {
      font-size: 0.875rem;
    }

    article th,
    article td {
      padding: 0.875rem 1rem;
    }
  }

  @media (max-width: 480px) {
    article table {
      font-size: 0.8rem;
    }

    article th,
    article td {
      padding: 0.75rem 0.875rem;
    }
  }

  .youtube-embed-container {
    position: relative;
    padding-bottom: 56.25%; /* 16:9 */
    height: 0;
    margin-bottom: 2rem;
    margin-top: 2rem;
    border-radius: 16px;
    overflow: hidden;
    box-shadow: 
      0 12px 36px rgba(0, 0, 0, 0.5),
      0 4px 12px rgba(0, 0, 0, 0.3);
    border: 2px solid rgba(255, 255, 255, 0.1);
    transition: all 0.3s ease;
  }
  
  .youtube-embed-container:hover {
    transform: translateY(-4px);
    box-shadow: 
      0 20px 48px rgba(0, 0, 0, 0.6),
      0 8px 16px rgba(0, 0, 0, 0.4);
    border-color: rgba(255, 255, 255, 0.15);
  }
  
  .youtube-embed-container iframe {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    border: none;
  }
  .youtube-label {
    margin-top: 2rem;
    font-size: 1rem;
    text-align: left;
    color: #fff;
    font-weight: bold;
    letter-spacing: 0.05em;
    padding: 0.75rem 1.5rem;
    background: linear-gradient(135deg, rgba(255, 0, 0, 0.15), rgba(255, 0, 0, 0.05));
    border-left: 4px solid #ff0000;
    border-radius: 8px;
    box-shadow: 
      0 4px 12px rgba(255, 0, 0, 0.2),
      inset 0 1px 0 rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(10px);
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
  }
  
  .youtube-label::before {
    content: "‚ñ∂";
    color: #ff0000;
    font-size: 1.2em;
  }

  /* Link Card Styles */
  .link-card-wrapper {
    /* @apply my-6; */
  }

  .link-card-container {
    display: block;
    text-decoration: none;
    color: inherit;
    transition: all 0.3s ease;
  }

  .link-card {
    display: flex;
    gap: 1rem;
    padding: 1rem;
    background: rgba(255, 255, 255, 0.03);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 12px;
    overflow: hidden;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    box-shadow:
      0 4px 12px rgba(0, 0, 0, 0.3),
      0 1px 3px rgba(0, 0, 0, 0.2);
  }

  .link-card:hover {
    transform: translateY(-2px);
    border-color: rgba(var(--color-primary-rgb), 0.5);
    background: rgba(255, 255, 255, 0.05);
    box-shadow:
      0 8px 24px rgba(0, 0, 0, 0.4),
      0 2px 6px rgba(var(--color-primary-rgb), 0.3);
  }

  .link-card-thumbnail {
    flex-shrink: 0;
    width: 150px;
    height: 150px;
    border-radius: 8px;
    overflow: hidden;
    background: rgba(0, 0, 0, 0.2);
  }

  .link-card-thumbnail img {
    width: 100%;
    height: 100%;
    object-fit: contain;
    object-position: center center;
    margin: 0 !important;
    box-shadow: none !important;
    border: none !important;
    transition: transform 0.3s ease;
  }

  .link-card:hover .link-card-thumbnail img {
    transform: scale(1.05);
  }

  .link-card-content {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
    min-width: 0;
  }

  .link-card-header {
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }

  .link-card-favicon {
    width: 16px;
    height: 16px;
    flex-shrink: 0;
  }

  .link-card-site-name {
    font-size: 0.75rem;
    color: rgba(255, 255, 255, 0.6);
    font-weight: 500;
  }

  .link-card-title {
    font-size: 1rem;
    font-weight: 600;
    line-height: 1.4;
    margin: 0 !important;
    padding: 0 !important;
    border: none !important;
    overflow: hidden;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
  }

  .link-card-title::before {
    content: none !important;
  }

  .link-card-description {
    font-size: 0.875rem;
    line-height: 1.5;
    color: rgba(255, 255, 255, 0.7);
    overflow: hidden;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
  }

  /* Loading skeleton */
  .link-card-skeleton {
    display: flex;
    gap: 1rem;
    padding: 1rem;
    background: rgba(255, 255, 255, 0.03);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 12px;
  }

  .skeleton-thumbnail {
    width: 150px;
    height: 150px;
    background: linear-gradient(
      90deg,
      rgba(255, 255, 255, 0.05) 0%,
      rgba(255, 255, 255, 0.1) 50%,
      rgba(255, 255, 255, 0.05) 100%
    );
    background-size: 200% 100%;
    animation: skeleton-loading 1.5s ease-in-out infinite;
    border-radius: 8px;
  }

  .skeleton-content {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
  }

  .skeleton-title {
    height: 1.25rem;
    width: 80%;
    background: linear-gradient(
      90deg,
      rgba(255, 255, 255, 0.05) 0%,
      rgba(255, 255, 255, 0.1) 50%,
      rgba(255, 255, 255, 0.05) 100%
    );
    background-size: 200% 100%;
    animation: skeleton-loading 1.5s ease-in-out infinite;
    border-radius: 4px;
  }

  .skeleton-description {
    height: 3rem;
    width: 100%;
    background: linear-gradient(
      90deg,
      rgba(255, 255, 255, 0.05) 0%,
      rgba(255, 255, 255, 0.1) 50%,
      rgba(255, 255, 255, 0.05) 100%
    );
    background-size: 200% 100%;
    animation: skeleton-loading 1.5s ease-in-out infinite;
    border-radius: 4px;
  }

  .skeleton-site {
    height: 0.875rem;
    width: 40%;
    background: linear-gradient(
      90deg,
      rgba(255, 255, 255, 0.05) 0%,
      rgba(255, 255, 255, 0.1) 50%,
      rgba(255, 255, 255, 0.05) 100%
    );
    background-size: 200% 100%;
    animation: skeleton-loading 1.5s ease-in-out infinite;
    border-radius: 4px;
  }

  @keyframes skeleton-loading {
    0% {
      background-position: 200% 0;
    }
    100% {
      background-position: -200% 0;
    }
  }

  /* Fallback styles */
  .link-card-fallback {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 1rem;
    background: rgba(255, 255, 255, 0.03);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 12px;
    transition: all 0.3s ease;
  }

  .link-card-fallback:hover {
    background: rgba(255, 255, 255, 0.05);
    border-color: rgba(var(--color-primary-rgb), 0.4);
  }

  .fallback-icon {
    font-size: 1.5rem;
  }

  .fallback-url {
    font-size: 0.875rem;
    color: var(--color-primary);
    word-break: break-all;
  }

  /* Responsive styles */
  @media (max-width: 640px) {
    .link-card {
      flex-direction: column;
    }

    .link-card-thumbnail {
      width: 100%;
      height: 200px;
    }
  }
</style>

<style>
  .blog-detail-wrapper {
    min-height: 100vh;
    width: 100%;
    display: grid;
    grid-template:
      "blog-detail-header blog-detail-header blog-detail-header" 50px
      "center center right " 1fr
      "footer footer footer" 100px
      / auto 1fr 320px;
    grid-gap: 10px 100px;
  }

  .blog-detail-header {
    grid-area: blog-detail-header;
  }

  .main {
    grid-area: center;
  }

  nav {
    grid-area: left;
  }

  aside {
    grid-area: right;
    position: sticky;
    top: 120px;
    align-self: start;
    max-height: calc(100vh - 140px);
    overflow-y: auto;
    display: flex;
    flex-direction: column;
    gap: 2rem;
  }

  /* „Çπ„ÇØ„É≠„Éº„É´„Éê„Éº„ÅÆ„Çπ„Çø„Ç§„É™„É≥„Ç∞ÔºàasideÁî®Ôºâ */
  aside::-webkit-scrollbar {
    width: 6px;
  }

  aside::-webkit-scrollbar-track {
    background: rgba(0, 0, 0, 0.2);
    border-radius: 3px;
  }

  aside::-webkit-scrollbar-thumb {
    background: rgba(156, 163, 175, 0.5);
    border-radius: 3px;
  }

  aside::-webkit-scrollbar-thumb:hover {
    background: rgba(156, 163, 175, 0.7);
  }

  .profile-section {
    margin-top: 0;
  }

  .aside-title {
    @apply text-xl font-bold mb-4;
    border-bottom: 1px solid var(--border-color);
    padding-bottom: 8px;
  }

  .footer {
    grid-area: footer;
  }

  /* „Ç´„ÉÜ„Ç¥„É™„Çª„ÇØ„Ç∑„Éß„É≥ */
  .category-section {
    margin-top: 1rem;
  }

  /* Ë®ò‰∫ãÊúÄÂæå„ÅÆ„Çª„ÇØ„Ç∑„Éß„É≥ */
  .article-footer-sections {
    margin-top: 4rem;
    display: flex;
    flex-direction: column;
    gap: 3rem;
  }

  .share-section,
  .related-posts-section {
    padding: 2rem;
    background: rgba(40, 40, 40, 0.6);
    border-radius: 12px;
    border: 1px solid rgba(255, 255, 255, 0.1);
  }

  .section-title {
    font-size: 1.5rem;
    font-weight: bold;
    margin-bottom: 1.5rem;
    padding-bottom: 0.75rem;
    border-bottom: 2px solid rgba(var(--color-primary-rgb), 0.5);
    color: #ffffff;
  }

  /* „Éá„Éï„Ç©„É´„Éà„Åß„É¢„Éê„Ç§„É´Áî®ÁõÆÊ¨°„ÅØÈùûË°®Á§∫ */
  .toc-mobile {
    display: block;
  }

  @media (min-width: 1025px) {
    /* PCË°®Á§∫ÊôÇ„ÅØ„É¢„Éê„Ç§„É´Áî®ÁõÆÊ¨°„ÇíÈùûË°®Á§∫ */
    .toc-mobile {
      display: none;
    }
  }

  @media (max-width: 1024px) {
    .blog-detail-wrapper {
      grid-template:
        "blog-detail-header blog-detail-header blog-detail-header" 70px
        "center center center " 1fr
        "right  right  right " auto
        / 1fr;
      grid-gap: 10px 100px;
    }

    /* „É¢„Éê„Ç§„É´Ë°®Á§∫ÊôÇ„ÅØaside„Çísticky„Å´„Åó„Å™„ÅÑ */
    aside {
      position: relative;
      top: auto;
      max-height: none;
      overflow-y: visible;
    }

    /* „É¢„Éê„Ç§„É´Ë°®Á§∫ÊôÇ„ÅØ„É¢„Éê„Ç§„É´Áî®ÁõÆÊ¨°„ÇíË°®Á§∫ */
    .toc-mobile {
      display: block;
    }
  }
</style>
